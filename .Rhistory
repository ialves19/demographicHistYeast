getwd()
SFSfolder <- "/Users/isabel/Dropbox/UnivSTRASBOURG/PROJECTS/demoHist_yeast3039/05-results"
obsSFS <- c("SCALLING_WildEast_haploid/OneDomest_DSFS.obs",
"CHINESEwild/OneDomest_dSFS/OneDomest_DSFS.obs",
"TAIWANESEwild/OneDomestTaiw_dSFS/OneDomestTaiw_DSFS.obs")
names(obsSFS) <- c("31samples", "27samples", "25samples")
?read.table
SFSfolder <- "/Users/isabel/Dropbox/UnivSTRASBOURG/PROJECTS/demoHist_yeast3039/05-results"
obsSFS <- c("SCALLING_WildEast_haploid/OneDomest_DSFS.obs",
"CHINESEwild/OneDomest_dSFS/OneDomest_DSFS.obs",
"TAIWANESEwild/OneDomestTaiw_dSFS/OneDomestTaiw_DSFS.obs")
names(obsSFS) <- c("31samples", "27samples", "25samples")
obs <- obsSFS[1]
obs
fileName <- paste0(SFSfolder, "/", obs)
fileName
tmpSamples
tmpSamples <- read.table(file=fileName, skip = 1, nrows = 1)
tmpSamples
SFSfolder <- "/Users/isabel/Dropbox/UnivSTRASBOURG/PROJECTS/demoHist_yeast3039/05-results"
obsSFS <- c("SCALLING_WildEast_haploid/OneDomest_dSFS/multi-SFS/OneDomest_DSFS.obs",
"CHINESEwild/OneDomest_dSFS/OneDomest_DSFS.obs",
"TAIWANESEwild/OneDomestTaiw_dSFS/OneDomestTaiw_DSFS.obs")
names(obsSFS) <- c("31samples", "27samples", "25samples")
obs <- obsSFS[1]
fileName <- paste0(SFSfolder, "/", obs)
tmpSamples <- read.table(file=fileName, skip = 1, nrows = 1)
tmpSamples
tmpObs <- read.table(file=fileName, skip = 2, nrows = 1)
sfsSize[[obs]]$length <- length(tmpObs)
sfsSize <- list()
sfsSize[[obs]]$length <- length(tmpObs)
sfsSize
sfsSize[[obs]]$nonzero <- sum(tmpObs != 0)
sfsSize
SFSfolder <- "/Users/isabel/Dropbox/UnivSTRASBOURG/PROJECTS/demoHist_yeast3039/05-results"
obsSFS <- c("SCALLING_WildEast_haploid/OneDomest_dSFS/multi-SFS/OneDomest_DSFS.obs",
"CHINESEwild/OneDomest_dSFS/OneDomest_DSFS.obs",
"TAIWANESEwild/OneDomestTaiw_dSFS/OneDomestTaiw_DSFS.obs")
names(obsSFS) <- c("31samples", "27samples", "25samples")
sfsSize <- list()
for(obs in 1:length(obsSFS)){
#obs <- obsSFS[1]
fileName <- paste0(SFSfolder, "/", obsSFS[obs])
tmpSamples <- read.table(file=fileName, skip = 1, nrows = 1)
tmpObs <- read.table(file=fileName, skip = 2, nrows = 1)
sfsSize[[names(obsSFS)[obs]]]$length <- length(tmpObs)
sfsSize[[names(obsSFS)[obs]]]$nonzero <- sum(tmpObs != 0)
}
SFSfolder <- "/Users/isabel/Dropbox/UnivSTRASBOURG/PROJECTS/demoHist_yeast3039/05-results"
obsSFS <- c("SCALLING_WildEast_haploid/OneDomest_dSFS/multi-SFS/OneDomest_DSFS.obs",
"FiveClades/CHINESEwild/OneDomest_dSFS/OneDomest_DSFS.obs",
"FiveClades/TAIWANESEwild/OneDomestTaiw_dSFS/OneDomestTaiw_DSFS.obs")
names(obsSFS) <- c("31samples", "27samples", "25samples")
sfsSize <- list()
for(obs in 1:length(obsSFS)){
#obs <- obsSFS[1]
fileName <- paste0(SFSfolder, "/", obsSFS[obs])
tmpSamples <- read.table(file=fileName, skip = 1, nrows = 1)
tmpObs <- read.table(file=fileName, skip = 2, nrows = 1)
sfsSize[[names(obsSFS)[obs]]]$length <- length(tmpObs)
sfsSize[[names(obsSFS)[obs]]]$nonzero <- sum(tmpObs != 0)
}
sfsSize
data.frame(sfsSize)
data.frame(sfsSize)
?data.frame
as.data.frame(sfsSize)
?as.data.frame
matrix(sfsSize, nrow = 2, byrow = T)
matrix(sfsSize, nrow = 2, byrow = F)
matrix(unlist(sfsSize), nrow = 2, byrow = F)
mSfsSize <- t(matrix(unlist(sfsSize), nrow = 2, byrow = F))
rownames(mSfsSize) <- c("31samples", "27samples", "25samples")
mSfsSize
colnames(mSfsSize) <- c("nbSFSentries", "NonzeroEntries")
mSfsSize
library(kableExtra)
library(tidyverse)
library(ggplot2)
library(knitr)
samplesAndData <-  data.frame(DataName=c("Chi+Taiw", "Chi", "Taiw"),
Samples=c(31,27,25),
nbCallableSitesNoMiss=c(8923794,8972807,8995776),
nbSNVsNoMiss=c(308717,290681,153234), nbNonCodingSNVs=c(48155,45085,23232))
samplesAndData <- cbind(samplesAndData, mSfsSize)
kable(samplesAndData, row.names = F, caption = "Dataset") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"), full_width = F)
library(reshape2)
library(plotly)
test_data <-
data.frame(
var0 = 100 + c(0, cumsum(runif(49, -20, 20))),
var1 = 150 + c(0, cumsum(runif(49, -10, 10))),
date = seq(as.Date("2002-01-01"), by="1 month", length.out=100)
)
test_data_long <- melt(test_data, id="date")  # convert to long format
p <- ggplot(data=test_data_long,
aes(x=date, y=value, colour=variable)) +
geom_line()
fig <- ggplotly(p)
fig
fig
sfs1d.df.long <-  sfs1d.df %>% mutate(sfsEntries=row.names(sfs1d.df)) %>% pivot_longer(-sfsEntries,names_to = "boot", values_to="SFS-1D") %>%
?theme_classic()
